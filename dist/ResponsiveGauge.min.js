/*!
 * ResponsiveGauge
 * version : 0.1.0
 * license : MIT
 * authors : MikaÃ«l Restoux, Matt Magoffin (http://bl.ocks.org/msqr/3202712)
 * 
 */
var ResponsiveGaugeFactory=function(e,t){"use strict";"undefined"==typeof d3&&(d3=e),"undefined"==typeof numbro&&(numbro=t);var n=6,r=2,a=100,i=40,o=numbro(),s=function(e,t){function n(e,t){0===e.decimalsMax?this[t]=e.mantissaMax+".a":this[t]=e.mantissaMax+".["+new Array(e.decimalsMax+1).join("0")+"]a"}var r,a;return t?(r="LABEL_FORMAT",a=this.labels,void 0===this.LABEL_FORMAT&&n.call(this,a,r)):(r="VALUE_FORMAT",a=this.value,void 0===this.VALUE_FORMAT&&n.call(this,a,r)),o.set(e).format(this[r])},l={ring:{shift:3,width:7,minAngle:-90,maxAngle:90,sectorsNumber:5,border:!1,colors:!1,startColor:"#ffebee",endColor:"#810301"},pointer:{type:"needle",slowness:200,needleLength:90,filamentLength:2,fillerWidth:null,fillerShift:0},data:{min:0,max:100,value:0},labels:{number:null,formatter:function(e){return s.call(this,e,!0)},mantissaMax:4,decimalsMax:0,shift:0},value:{show:!0,shift:22,formatter:function(e){return s.call(this,e,!1)},mantissaMax:4,decimalsMax:0,unit:""}},u=function(e,t){function o(e){return e*Math.PI/180}function s(){if(null===_.labels.number&&(_.labels.number=_.ring.sectorsNumber),0===_.labels.number)return[];var e=(_.data.max-_.data.min)/(_.labels.number-1),t=d3.range(_.data.min,_.data.max,e);return t.push(_.data.max),t}function d(e,t,n){for(var r in t)if(t.hasOwnProperty(r)){var a=t[r];"object"==typeof a&&a.constructor!==Array?(void 0===e[r]&&(e[r]={}),d(e[r],a,n[r])):(e[r]=a,void 0===n[r]&&console.warn("Config property "+r+" is unknwon"))}}function f(e){_=JSON.parse(JSON.stringify(l)),_.labels.formatter=l.labels.formatter,_.value.formatter=l.value.formatter,d(_,e,l),_.FORMAT=void 0,_.labels.formatter=_.labels.formatter.bind(_),_.value.formatter=_.value.formatter.bind(_)}function c(e){f(e),M=_.ring.maxAngle-_.ring.minAngle,p(),w=d3.scale.linear().range([0,1]).domain([_.data.min,_.data.max]),j=s(),_.ring.colors.constructor===Array?(E=d3.range(_.ring.sectorsNumber).map(function(){return 1/_.ring.sectorsNumber}),F=function(e){var t=Math.floor(e*_.ring.sectorsNumber);return t=Math.min(t,_.ring.colors.length-1),_.ring.colors[t]}):_.ring.colors?(E="gradient"===_.ring.colors?d3.range(i).map(function(){return 1/i}):d3.range(_.ring.sectorsNumber).map(function(){return 1/_.ring.sectorsNumber}),F=d3.interpolateHsl(d3.rgb(_.ring.startColor),d3.rgb(_.ring.endColor))):E=[1],N=g(function(e,t){var n=e*t,r=0===t?0:.5;return o(_.ring.minAngle+n*M-r)},function(e,t){var n=e*(t+1);return o(_.ring.minAngle+n*M)},_.ring.width,_.ring.shift),_.ring.border&&(O=g(o(_.ring.minAngle),o(_.ring.maxAngle),_.ring.width,_.ring.shift)),"filler"===_.pointer.type&&null===_.pointer.fillerWidth&&(_.pointer.fillerWidth=_.ring.width,_.pointer.fillerShift=_.ring.shift)}function g(e,t,n,r){return d3.svg.arc().innerRadius(C-n-r).outerRadius(C-r).startAngle(e).endAngle(t)}function m(){var e=JSON.parse(JSON.stringify(_));return Object.freeze(e),e}function p(){function e(e){return[t(r+e),t(a+e)]}function t(e){return i*Math.sin(o(e))}for(var r=_.ring.minAngle,a=_.ring.maxAngle,i=C-Math.min(_.ring.shift,_.pointer.fillerShift,_.labels.shift),s=0,l=0,u=0,d=0,f=Math.floor(r/90),c=Math.floor(a/90),g=f;c>=g;g++)switch(g%4){case 0:u=i;break;case 1:l=i;break;case 2:d=i;break;case 3:s=i}var m=e(0),p=e(-90);s=Math.abs(Math.min(-s,m[0],m[1])),l=Math.max(l,m[0],m[1]),u=Math.abs(Math.min(-u,p[0],p[1])),d=Math.max(d,p[0],p[1]),q=s+l+2*n,I=u+d+2*n;var h=u+n,v=s+n,b=3*i+4*n;I+q>b&&(G=!0,q+=2*n,I+=2*n,h+=n,v+=n),T="translate("+v+","+h+")"}function h(e){c(e),v();var t=S.append("g").attr("class","gauge-arc").attr("transform",T),n=t.selectAll("path").data(E).enter().append("path").attr("d",N);_.ring.colors&&n.attr("fill",function(e,t){return F(e*t)}),_.ring.border&&t.append("path").attr("fill","none").attr("class","gauge-arc-border").attr("d",O);var a=d3.svg.line().interpolate("monotone"),i=S.append("g").attr("class","gauge-pointer gauge-"+_.pointer.type).attr("transform",T);if("filler"===_.pointer.type)k=i.append("path");else if("needle"===_.pointer.type)k=i.data([[[0,-r],[0,-_.pointer.needleLength/2]]]).append("path").attr("d",a),i.append("circle").attr("r",r);else if("filament"===_.pointer.type){var o=C-_.ring.shift-_.ring.width-_.pointer.filamentLength,s=C-_.ring.shift+_.pointer.filamentLength;k=i.data([[[0,-o],[0,-s]]]).append("path").attr("d",a)}S.append("g").attr("class","gauge-label").attr("transform",T).selectAll("text").data(j).enter().append("g").attr("transform",function(e){var t=w(e),n=_.ring.minAngle+t*M;return"rotate("+n+") translate(0,"+(_.labels.shift-C)+")"}).append("text").text(_.labels.formatter);if(_.value.show){var l=_.value.shift,u=_.ring.minAngle+Math.abs(M)/2;G&&(l=0,u=0);var d="translate(0, "+-l+")",f=S.append("g").attr("class","gauge-value").attr("transform",T+" rotate("+u+")").append("g").attr("transform",d+" rotate("+-u+")").append("text");R=f.append("tspan").attr("dy","0.4em"),f.append("tspan").text(_.value.unit).attr("class","unit").attr("x",0).attr("dy","1em")}}function v(){L=d3.select(e),window.navigator.userAgent.match(/(MSIE|Trident|Edge)/)&&(L.classed("gauge-container",!0),L.append("canvas").attr({"class":"gauge-ie-fix",width:q,height:I}),b()),S=L.classed("wide-gauge",G).append("svg:svg").attr("class","gauge").attr("viewBox","0 0 "+q+" "+I).attr("preserveAspectRatio","xMinYMin meet")}function b(){function e(e,t){var n=null;return function(){clearTimeout(n),n=setTimeout(function(){e()},t)}}u.ieListenerSet||(window.addEventListener("resize",e(function(){for(var e=document.querySelectorAll("canvas"),t=0;t<e.length;++t){var n=e[t];n.setAttribute("height",n.getAttribute("height"))}},250)),u.ieListenerSet=!0)}function x(e){if("filler"===_.pointer.type){var t=g(o(_.ring.minAngle),o(A(e)),_.pointer.fillerWidth,_.pointer.fillerShift);k.attr("d",t)}else k.transition().duration(_.pointer.slowness).ease("elastic").attr("transform","rotate("+A(e)+")")}function A(e){var t=Math.max(e,_.data.min);t=Math.min(t,_.data.max);var n=w(t);return _.ring.minAngle+n*M}function y(e,t){e=void 0===e?0:e,x(e),_.value.show&&R.text(_.value.formatter(e))}var M,w,R,L,S,k,N,O,j,E,F,T,_={},C=a/2,G=!1,q=0,I=0;return h(t),y(_.data.value),{update:y,getConfig:m,container:L}};if(u.config=l,"undefined"!=typeof module&&module.exports)module.exports=u;else{if("undefined"!=typeof requirejs)return u;this.ResponsiveGauge=u}};if("undefined"!=typeof module&&module.exports){var _d3=require("d3"),_numbro=require("numbro");ResponsiveGaugeFactory(_d3,_numbro)}else if("undefined"!=typeof requirejs){var protocol=document.location.protocol;protocol="file:"===protocol?"http:":protocol;var cssId="responsive-gauge-css";if(!document.getElementById(cssId)){var head=document.getElementsByTagName("head")[0],link=document.createElement("link");link.id=cssId,link.rel="stylesheet",link.type="text/css",link.href=protocol+"//cdn.rawgit.com/DeepSilence/ResponsiveGauge/9c2fa1bdced20a59f84d9385eebefae489e2dce0/dist/ResponsiveGauge.min.css",link.media="all",head.appendChild(link)}requirejs.config({paths:{d3:protocol+"//cdn.jsdelivr.net/d3js/3.5.16/d3.min",numbro:protocol+"//cdnjs.cloudflare.com/ajax/libs/numbro/1.7.1/numbro.min"}}),define(["d3","numbro"],function(e,t){return ResponsiveGaugeFactory(e,t)})}else ResponsiveGaugeFactory.call("undefined"==typeof window?this:window);