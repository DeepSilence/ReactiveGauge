/*!
 * ResponsiveGauge
 * version : 0.1.0
 * license : MIT
 * authors : MikaÃ«l Restoux, Matt Magoffin (http://bl.ocks.org/msqr/3202712)
 * 
 */
var ResponsiveGaugeFactory=function(e,t){"use strict";"undefined"==typeof d3&&(d3=e),"undefined"==typeof numbro&&(numbro=t);var a=6,r=2,n=100,i=40,l=numbro(),o=function(e,t){function a(e,t,a){0===t?this[a]=e+".a":this[a]=e+".["+new Array(t+1).join("0")+"]a"}var r;return t?(r="LABEL_FORMAT",void 0===this.LABEL_FORMAT&&a.call(this,this.labelMantissaMax,this.labelDecimalsMax,r)):(r="VALUE_FORMAT",void 0===this.VALUE_FORMAT&&a.call(this,this.valueMantissaMax,this.valueDecimalsMax,r)),l.set(e).format(this[r])},s={ringShift:3,ringWidth:7,minAngle:-90,maxAngle:90,sectorsNumber:5,border:!1,pointerType:"needle",pointerSlowness:200,needleLength:90,filamentLength:2,fillerWidth:NaN,fillerShift:0,minValue:0,maxValue:100,value:0,labelNumber:NaN,labelFormatter:function(e){return o.call(this,e,!0)},labelMantissaMax:4,labelDecimalsMax:0,labelShift:0,colors:!1,startColor:"#ffebee",endColor:"#810301",showValue:!0,valueShift:22,valueFormatter:function(e){return o.call(this,e,!1)},valueMantissaMax:4,valueDecimalsMax:0,valueUnit:""},u=function(e,t){function l(e){return e*Math.PI/180}function o(){if(isNaN(R.labelNumber)&&(R.labelNumber=R.sectorsNumber),0===R.labelNumber)return[];var e=(R.maxValue-R.minValue)/(R.labelNumber-1),t=d3.range(R.minValue,R.maxValue,e);return t.push(R.maxValue),t}function u(e){for(var t in s)R[t]=s[t];for(var t in e)R[t]=e[t],void 0===s[t]&&console.warn("Config property "+t+" is unknwon");R.FORMAT=void 0,R.labelFormatter=R.labelFormatter.bind(R),R.valueFormatter=R.valueFormatter.bind(R),v=R.maxAngle-R.minAngle,f(),b=d3.scale.linear().range([0,1]).domain([R.minValue,R.maxValue]),w=o(),R.colors.constructor===Array?(F=d3.range(R.sectorsNumber).map(function(){return 1/R.sectorsNumber}),V=function(e){var t=Math.floor(e*R.sectorsNumber);return t=Math.min(t,R.colors.length-1),R.colors[t]}):R.colors?(F="gradient"===R.colors?d3.range(i).map(function(){return 1/i}):d3.range(R.sectorsNumber).map(function(){return 1/R.sectorsNumber}),V=d3.interpolateHsl(d3.rgb(R.startColor),d3.rgb(R.endColor))):F=[1],N=d(function(e,t){var a=e*t,r=0===t?0:.5;return l(R.minAngle+a*v-r)},function(e,t){var a=e*(t+1);return l(R.minAngle+a*v)},R.ringWidth,R.ringShift),R.border&&(S=d(l(R.minAngle),l(R.maxAngle),R.ringWidth,R.ringShift)),"filler"===R.pointerType&&isNaN(R.fillerWidth)&&(R.fillerWidth=R.ringWidth,R.fillerShift=R.ringShift)}function d(e,t,a,r){return d3.svg.arc().innerRadius(T-a-r).outerRadius(T-r).startAngle(e).endAngle(t)}function c(){var e=JSON.parse(JSON.stringify(R));return Object.freeze(e),e}function f(){function e(e){return[t(n+e),t(i+e)]}function t(e){return o*Math.sin(l(e))}for(var r=a,n=R.minAngle,i=R.maxAngle,o=T-Math.min(R.ringShift,R.fillerShift,R.labelShift),s=0,u=0,d=0,c=0,f=Math.floor(n/90),m=Math.floor(i/90),p=f;m>=p;p++)switch(p%4){case 0:d=o;break;case 1:u=o;break;case 2:c=o;break;case 3:s=o}var g=e(0),h=e(-90);s=Math.abs(Math.min(-s,g[0],g[1])),u=Math.max(u,g[0],g[1]),d=Math.abs(Math.min(-d,h[0],h[1])),c=Math.max(c,h[0],h[1]),L=s+u+2*r,j=d+c+2*r,O=d+r,W=s+r;var v=3*o+4*r;j+L>v&&(k=!0,L+=2*r,j+=2*r,O+=r,W+=r)}function m(t){u(t),x=d3.select(e).classed("wide-gauge",k),A=x.append("svg:svg").attr("class","gauge").attr("viewBox","0 0 "+L+" "+j).attr("preserveAspectRatio","xMinYMin meet");var a="translate("+W+","+O+")",n=A.append("g").attr("class","gauge-arc").attr("transform",a),i=n.selectAll("path").data(F).enter().append("path").attr("d",N);R.colors&&i.attr("fill",function(e,t){return V(e*t)}),R.border&&n.append("path").attr("fill","none").attr("class","gauge-arc-border").attr("d",S);var l=d3.svg.line().interpolate("monotone"),o=A.append("g").attr("class","gauge-pointer gauge-"+R.pointerType).attr("transform",a);if("filler"===R.pointerType)y=o.append("path");else if("needle"===R.pointerType)y=o.data([[[0,-r],[0,-R.needleLength/2]]]).append("path").attr("d",l),o.append("circle").attr("r",r);else if("filament"===R.pointerType){var s=T-R.ringShift-R.ringWidth-R.filamentLength,d=T-R.ringShift+R.filamentLength;y=o.data([[[0,-s],[0,-d]]]).append("path").attr("d",l)}A.append("g").attr("class","gauge-label").attr("transform",a).selectAll("text").data(w).enter().append("g").attr("transform",function(e){var t=b(e),a=R.minAngle+t*v;return"rotate("+a+") translate(0,"+(R.labelShift-T)+")"}).append("text").text(R.labelFormatter);if(R.showValue){var c=R.valueShift,f=R.minAngle+Math.abs(v)/2;k&&(c=0,f=0);var m="translate(0, "+-c+")",p=A.append("g").attr("class","gauge-value").attr("transform",a+" rotate("+f+")").append("g").attr("transform",m+" rotate("+-f+")").append("text");M=p.append("tspan").attr("dy","0.4em"),p.append("tspan").text(R.valueUnit).attr("class","unit").attr("x",0).attr("dy","1em")}}function p(e){if("filler"===R.pointerType){var t=d(l(R.minAngle),l(h(e)),R.fillerWidth,R.fillerShift);y.attr("d",t)}else y.transition().duration(R.pointerSlowness).ease("elastic").attr("transform","rotate("+h(e)+")")}function g(e,t){e=void 0===e?0:e,p(e),R.showValue&&M.text(R.valueFormatter(e))}function h(e){var t=Math.max(e,R.minValue);t=Math.min(t,R.maxValue);var a=b(t);return R.minAngle+a*v}var v,b,M,x,A,y,N,S,w,F,V,R={},T=n/2,k=!1,L=0,j=0,W=0,O=0;return m(t),g(R.value),{update:g,getConfig:c,container:x}};return u.config=s,"undefined"!=typeof requirejs?u:void(this.ResponsiveGauge=u)};if("undefined"!=typeof requirejs){var protocol=document.location.protocol;protocol="file:"===protocol?"http:":protocol;var cssId="responsive-gauge-css";if(!document.getElementById(cssId)){var head=document.getElementsByTagName("head")[0],link=document.createElement("link");link.id=cssId,link.rel="stylesheet",link.type="text/css",link.href=protocol+"//cdn.rawgit.com/DeepSilence/ResponsiveGauge/69b33feebb300834edaa535df95fae1e68de59e9/dist/ResponsiveGauge.min.css",link.media="all",head.appendChild(link)}requirejs.config({paths:{d3:protocol+"//cdn.jsdelivr.net/d3js/3.5.16/d3.min",numbro:protocol+"//cdnjs.cloudflare.com/ajax/libs/numbro/1.7.1/numbro.min"}}),define(["d3","numbro"],function(e,t){return ResponsiveGaugeFactory(e,t)})}else ResponsiveGaugeFactory.call("undefined"==typeof window?this:window);