/*!
 * ResponsiveGauge
 * version : 0.1.0
 * license : MIT
 * author : MikaÃ«l Restoux, Matt Magoffin (http://bl.ocks.org/msqr/3202712)
 * 
 */
var ResponsiveGaugeFactory=function(e,t){"use strict";"undefined"==typeof d3&&(d3=e),"undefined"==typeof numbro&&(numbro=t);var a=6,r=2,n=100,i=40,o=numbro(),l=function(e,t){function a(e,t,a){0===t?this[a]=e+".a":this[a]=e+".["+new Array(t+1).join("0")+"]a"}if(t){var r="LABEL_FORMAT";void 0===this.LABEL_FORMAT&&a.call(this,this.labelMantissaMax,this.labelDecimalsMax,r)}else{var r="VALUE_FORMAT";void 0===this.VALUE_FORMAT&&a.call(this,this.valueMantissaMax,this.valueDecimalsMax,r)}return o.set(e).format(this[r])},s={ringShift:3,ringWidth:7,minAngle:-90,maxAngle:90,sectorsNumber:5,border:!1,pointerType:"needle",pointerSlowness:200,needleLength:90,filamentLength:2,fillerWidth:NaN,fillerShift:0,minValue:0,maxValue:100,value:0,labelNumber:NaN,labelFormatter:function(e){return l.call(this,e,!0)},labelMantissaMax:4,labelDecimalsMax:0,labelShift:0,colors:!1,startColor:"#ffebee",endColor:"#810301",showValue:!0,valueShift:22,valueFormatter:function(e){return l.call(this,e,!1)},valueMantissaMax:4,valueDecimalsMax:0,valueUnit:""},u=function(e,t){function o(e){return e*Math.PI/180}function l(){if(isNaN(v.labelNumber)&&(v.labelNumber=v.sectorsNumber),0===v.labelNumber)return[];var e=(v.maxValue-v.minValue)/(v.labelNumber-1),t=d3.range(v.minValue,v.maxValue,e);return t.push(v.maxValue),t}function u(e){for(var t in s)v[t]=s[t];for(var t in e)v[t]=e[t],void 0===s[t]&&console.warn("Config property "+t+" is unknwon");v.FORMAT=void 0,v.labelFormatter=v.labelFormatter.bind(v),v.valueFormatter=v.valueFormatter.bind(v),M=v.maxAngle-v.minAngle,c(),x=d3.scale.linear().range([0,1]).domain([v.minValue,v.maxValue]),w=l(),v.colors.constructor===Array?(R=d3.range(v.sectorsNumber).map(function(){return 1/v.sectorsNumber}),T=function(e){var t=Math.floor(e*v.sectorsNumber);return t=Math.min(t,v.colors.length-1),v.colors[t]}):v.colors?(R="gradient"===v.colors?d3.range(i).map(function(){return 1/i}):d3.range(v.sectorsNumber).map(function(){return 1/v.sectorsNumber}),T=d3.interpolateHsl(d3.rgb(v.startColor),d3.rgb(v.endColor))):R=[1],F=d(function(e,t){var a=e*t,r=0===t?0:.5;return o(v.minAngle+a*M-r)},function(e,t){var a=e*(t+1);return o(v.minAngle+a*M)},v.ringWidth,v.ringShift),v.border&&(V=d(o(v.minAngle),o(v.maxAngle),v.ringWidth,v.ringShift)),"filler"===v.pointerType&&isNaN(v.fillerWidth)&&(v.fillerWidth=v.ringWidth,v.fillerShift=v.ringShift)}function d(e,t,a,r){return d3.svg.arc().innerRadius(b-a-r).outerRadius(b-r).startAngle(e).endAngle(t)}function f(){var e=JSON.parse(JSON.stringify(v));return Object.freeze(e),e}function c(){function e(e){return[t(n+e),t(i+e)]}function t(e){return l*Math.sin(o(e))}for(var r=a,n=v.minAngle,i=v.maxAngle,l=b-Math.min(v.ringShift,v.fillerShift,v.labelShift),s=0,u=0,d=0,f=0,c=Math.floor(n/90),p=Math.floor(i/90),m=c;p>=m;m++)switch(m%4){case 0:d=l;break;case 1:u=l;break;case 2:f=l;break;case 3:s=l}var g=e(0),h=e(-90);s=Math.abs(Math.min(-s,g[0],g[1])),u=Math.max(u,g[0],g[1]),d=Math.abs(Math.min(-d,h[0],h[1])),f=Math.max(f,h[0],h[1]),j=s+u+2*r,W=d+f+2*r,C=d+r,O=s+r;var M=3*l+4*r;W+j>M&&(L=!0,j+=2*r,W+=2*r,C+=r,O+=r)}function p(t){u(t),N=d3.select(e).classed("wide-gauge",L),y=N.append("svg:svg").attr("class","gauge").attr("viewBox","0 0 "+j+" "+W).attr("preserveAspectRatio","xMinYMin meet");var a="translate("+O+","+C+")",n=y.append("g").attr("class","gauge-arc").attr("transform",a),i=n.selectAll("path").data(R).enter().append("path").attr("d",F);v.colors&&i.attr("fill",function(e,t){return T(e*t)}),v.border&&n.append("path").attr("fill","none").attr("class","gauge-arc-border").attr("d",V);var o=d3.svg.line().interpolate("monotone"),l=y.append("g").attr("class","gauge-pointer gauge-"+v.pointerType).attr("transform",a);if("filler"===v.pointerType)S=l.append("path");else if("needle"===v.pointerType)S=l.data([[[0,-r],[0,-v.needleLength/2]]]).append("path").attr("d",o),l.append("circle").attr("r",r);else if("filament"===v.pointerType){var s=b-v.ringShift-v.ringWidth-v.filamentLength,d=b-v.ringShift+v.filamentLength;S=l.data([[[0,-s],[0,-d]]]).append("path").attr("d",o)}y.append("g").attr("class","gauge-label").attr("transform",a).selectAll("text").data(w).enter().append("g").attr("transform",function(e){var t=x(e),a=v.minAngle+t*M;return"rotate("+a+") translate(0,"+(v.labelShift-b)+")"}).append("text").text(v.labelFormatter);if(v.showValue){var f=v.valueShift,c=v.minAngle+Math.abs(M)/2;L&&(f=0,c=0);var p="translate(0, "+-f+")",m=y.append("g").attr("class","gauge-value").attr("transform",a+" rotate("+c+")").append("g").attr("transform",p+" rotate("+-c+")").append("text");A=m.append("tspan"),m.append("tspan").text(v.valueUnit).attr("class","unit").attr("x",0).attr("dy","1em")}}function m(e){if("filler"===v.pointerType){var t=d(o(v.minAngle),o(h(e)),v.fillerWidth,v.fillerShift);S.attr("d",t)}else S.transition().duration(v.pointerSlowness).ease("elastic").attr("transform","rotate("+h(e)+")")}function g(e,t){e=void 0===e?0:e,m(e),v.showValue&&A.text(v.valueFormatter(e))}function h(e){var t=Math.max(e,v.minValue);t=Math.min(t,v.maxValue);var a=x(t);return v.minAngle+a*M}var v={},b=n/2,M=void 0,x=void 0,A=void 0,N=void 0,y=void 0,S=void 0,F=void 0,V=void 0,w=void 0,R=void 0,T=void 0,L=!1,j=0,W=0,O=0,C=0;return p(t),g(v.value),{update:g,getConfig:f,container:N}};return u.config=s,"undefined"!=typeof requirejs?u:void(this.ResponsiveGauge=u)};if("undefined"!=typeof requirejs){var protocol=document.location.protocol;protocol="file:"===protocol?"http:":protocol,requirejs.config({paths:{d3:protocol+"//cdn.jsdelivr.net/d3js/3.5.16/d3.min",numbro:protocol+"//cdnjs.cloudflare.com/ajax/libs/numbro/1.7.1/numbro.min"}}),define(["d3","numbro"],function(e,t){return ResponsiveGaugeFactory(e,t)})}else ResponsiveGaugeFactory.call("undefined"==typeof window?this:window);