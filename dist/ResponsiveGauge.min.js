/*!
 * ResponsiveGauge
 * version : 0.1.0
 * license : MIT
 * authors : MikaÃ«l Restoux, Matt Magoffin (http://bl.ocks.org/msqr/3202712)
 * 
 */
var ResponsiveGaugeFactory=function(e,t){"use strict";"undefined"==typeof d3&&(d3=e),"undefined"==typeof numbro&&(numbro=t);var r=numbro.cultureData(),a={thousands:1e3,decimal:1.1};for(var n in a){var i=a[n].toLocaleString().replace(/\d/g,"");0!==i.length&&(r.delimiters[n]=i)}var o=".gauge-container{display:inline-block;position:relative}.gauge-container .gauge{position:absolute;top:0;left:0}.gauge-ie-fix{display:block;height:100%;width:100%;visibility:hidden}.gauge{display:inline-block;overflow:visible;height:100%;max-width:100%}.gauge-needle{stroke:#cf4814;fill:transparent}.gauge-filament{stroke:#000}.gauge-filler{fill:#d50000}.gauge-arc{fill:#ddd}.gauge-arc-border{stroke:#ccc;stroke-width:.3px}.gauge text{fill:#333}.gauge-label text{text-anchor:middle;font-weight:700;font-size:4px}.wide-gauge .gauge-label text{font-size:8px}.gauge-label g:first-child text{text-anchor:start}.gauge-label g:last-child text{text-anchor:end}.gauge-value text{font-size:12px;text-anchor:middle}.wide-gauge .gauge-value text{font-size:24px}.unit{font-size:.7em}",l=6,s=2,u=100,d=40,f=numbro(),g=function(e,t){function r(e,t){0===e.decimalsMax?this[t]=e.mantissaMax+",.a":this[t]=e.mantissaMax+",.["+new Array(e.decimalsMax+1).join("0")+"]a"}var a,n;return t?(a="LABEL_FORMAT",n=this.labels,void 0===this.LABEL_FORMAT&&r.call(this,n,a)):(a="VALUE_FORMAT",n=this.value,void 0===this.VALUE_FORMAT&&r.call(this,n,a)),f.set(e).format(this[a])},c={ring:{shift:3,width:7,minAngle:-90,maxAngle:90,sectorsNumber:5,border:!1,colors:!1,startColor:"#ffebee",endColor:"#810301"},pointer:{type:"needle",slowness:200,needleLength:90,filamentLength:2,fillerWidth:null,fillerShift:null,colors:!1,startColor:"#ffebee",endColor:"#810301"},data:{min:0,max:100,value:0},labels:{number:null,formatter:function(e){return g.call(this,e,!0)},mantissaMax:4,decimalsMax:0,shift:0},value:{show:!0,shift:22,formatter:function(e){return g.call(this,e,!1)},mantissaMax:4,decimalsMax:0,unit:""}},p=function(e,t){function r(e){return e*Math.PI/180}function a(){if(null===_.labels.number&&(_.labels.number=_.ring.sectorsNumber),0===_.labels.number)return[];var e=(_.data.max-_.data.min)/(_.labels.number-1),t=d3.range(_.data.min,_.data.max,e);return t.push(_.data.max),t}function n(e,t,r){for(var a in t)if(t.hasOwnProperty(a)){var i=t[a];"object"==typeof i&&i.constructor!==Array?(void 0===e[a]&&(e[a]={}),n(e[a],i,r[a])):(e[a]=i,void 0===r[a]&&console.warn("Config property "+a+" is unknwon"))}}function i(e){_=JSON.parse(JSON.stringify(c)),_.labels.formatter=c.labels.formatter,_.value.formatter=c.value.formatter,n(_,e,c),_.FORMAT=void 0,_.labels.formatter=_.labels.formatter.bind(_),_.value.formatter=_.value.formatter.bind(_)}function o(e){i(e),M=_.ring.maxAngle-_.ring.minAngle,v(),L=d3.scale.linear().range([0,1]).domain([_.data.min,_.data.max]),T=a(),m(),C=g(function(e,t){var a=e*t,n=0===t?0:.5;return r(_.ring.minAngle+a*M-n)},function(e,t){var a=e*(t+1);return r(_.ring.minAngle+a*M)},_.ring.width,_.ring.shift),_.ring.border&&(j=g(_.ring.minAngle,_.ring.maxAngle,_.ring.width,_.ring.shift)),"filler"===_.pointer.type&&(null===_.pointer.fillerWidth&&(_.pointer.fillerWidth=_.ring.width),null===_.pointer.fillerShift&&(_.pointer.fillerShift=_.ring.shift))}function f(e){return Array.apply(null,Array(e)).map(Number.prototype.valueOf,1/e)}function g(e,t,a,n){return e="number"==typeof e?r(e):e,t="number"==typeof t?r(t):t,d3.svg.arc().innerRadius(z-a-n).outerRadius(z-n).startAngle(e).endAngle(t)}function m(){var e=_.ring;e.colors.constructor===Array?(E=f(e.colors.length),F=function(t){var r=Math.floor(t*e.colors.length);return e.colors[r]}):e.colors?(E=f("gradient"===e.colors?d:e.sectorsNumber),F=d3.interpolateHsl(d3.rgb(e.startColor),d3.rgb(e.endColor))):E=f(1)}function h(){var e=JSON.parse(JSON.stringify(_));return Object.freeze(e),e}function v(){function e(e){return[t(a+e),t(n+e)]}function t(e){return i*Math.sin(r(e))}for(var a=_.ring.minAngle,n=_.ring.maxAngle,i=z-Math.min(_.ring.shift,_.pointer.fillerShift,_.labels.shift),o=0,s=0,u=0,d=0,f=Math.floor(a/90),g=Math.floor(n/90),c=f;g>=c;c++)switch(c%4){case 0:u=i;break;case 1:s=i;break;case 2:d=i;break;case 3:o=i}var p=e(0),m=e(-90);o=Math.abs(Math.min(-o,p[0],p[1])),s=Math.max(s,p[0],p[1]),u=Math.abs(Math.min(-u,m[0],m[1])),d=Math.max(d,m[0],m[1]),G=o+s+2*l,B=u+d+2*l;var h=u+l,v=o+l,b=3*i+4*l;B+G>b&&(q=!0,G+=2*l,B+=2*l,h+=l,v+=l),N="translate("+v+","+h+")"}function b(e){o(e),x();var t=O.append("g").attr("class","gauge-arc").attr("transform",N),r=t.selectAll("path").data(E).enter().append("path").attr("d",C);_.ring.colors&&r.attr("fill",function(e,t){return F(e*t)}),_.ring.border&&t.append("path").attr("fill","none").attr("class","gauge-arc-border").attr("d",j);var a=d3.svg.line().interpolate("monotone"),n=O.append("g").attr("class","gauge-pointer gauge-"+_.pointer.type).attr("transform",N);if("filler"===_.pointer.type)k=n.append("path");else if("needle"===_.pointer.type)k=n.data([[[0,-s],[0,-_.pointer.needleLength/2]]]).append("path").attr("d",a),n.append("circle").attr("r",s);else if("filament"===_.pointer.type){var i=z-_.ring.shift-_.ring.width-_.pointer.filamentLength,l=z-_.ring.shift+_.pointer.filamentLength;k=n.data([[[0,-i],[0,-l]]]).append("path").attr("d",a)}O.append("g").attr("class","gauge-label").attr("transform",N).selectAll("text").data(T).enter().append("g").attr("transform",function(e){var t=L(e),r=_.ring.minAngle+t*M;return"rotate("+r+") translate(0,"+(_.labels.shift-z)+")"}).append("text").text(_.labels.formatter);if(_.value.show){var u=_.value.shift,d=_.ring.minAngle+Math.abs(M)/2;q&&(u=0,d=0);var f="translate(0, "+-u+")",g=O.append("g").attr("class","gauge-value").attr("transform",N+" rotate("+d+")").append("g").attr("transform",f+" rotate("+-d+")").append("text"),c=_.value.unit?"0":"0.4em";S=g.append("tspan").attr("dy",c),g.append("tspan").text(_.value.unit).attr("class","unit").attr("x",0).attr("dy","1em")}}function x(){R=d3.select(e),window.navigator.userAgent.match(/(MSIE|Trident|Edge)/)&&(R.classed("gauge-container",!0),R.append("canvas").attr({"class":"gauge-ie-fix",width:G,height:B}),y()),O=R.classed("wide-gauge",q).append("svg:svg").attr("class","gauge").attr("viewBox","0 0 "+G+" "+B).attr("preserveAspectRatio","xMinYMin meet")}function y(){function e(e,t){var r=null;return function(){clearTimeout(r),r=setTimeout(function(){e()},t)}}p.ieListenerSet||(window.addEventListener("resize",e(function(){for(var e=document.querySelectorAll("canvas"),t=0;t<e.length;++t){var r=e[t];r.setAttribute("height",r.getAttribute("height"))}},250)),p.ieListenerSet=!0)}function A(){var e=_.pointer,t=Math.max(_.data.value,_.data.min);t=Math.min(t,_.data.max);var r=L(t),a=_.ring.minAngle+r*M;if("filler"===e.type){var n=null;if(e.colors.constructor===Array){var i=Math.floor(r*e.colors.length);n=e.colors[i]}else"gradient"===e.colors&&(n=d3.interpolateHsl(d3.rgb(e.startColor),d3.rgb(e.endColor))(r));var o=g(_.ring.minAngle,a,e.fillerWidth,e.fillerShift);k.attr("d",o).attr("fill",n)}else k.transition().duration(e.slowness).ease("elastic").attr("transform","rotate("+a+")")}function w(e,t){_.data.value=void 0===e?0:e,A(),_.value.show&&S.text(_.value.formatter(_.data.value))}var M,L,S,R,O,k,C,j,T,E,F,N,_={},z=u/2,q=!1,G=0,B=0;return b(t),w(_.data.value),{update:w,getConfig:h,container:R}};p.config=c;var m=document.createElement("style");if(m.type="text/css",m.innerHTML=o,document.getElementsByTagName("head")[0].appendChild(m),"undefined"!=typeof module&&module.exports)module.exports=p;else{if("undefined"!=typeof requirejs)return p;this.ResponsiveGauge=p}};if("undefined"!=typeof module&&module.exports){var _d3=require("d3"),_numbro=require("numbro");ResponsiveGaugeFactory(_d3,_numbro)}else if("undefined"!=typeof requirejs){var protocol=document.location.protocol;protocol="file:"===protocol?"http:":protocol,requirejs.config({paths:{d3:protocol+"//cdn.jsdelivr.net/d3js/3.5.16/d3.min",numbro:protocol+"//cdnjs.cloudflare.com/ajax/libs/numbro/1.7.1/numbro.min"}}),define(["d3","numbro"],function(e,t){return ResponsiveGaugeFactory(e,t)})}else ResponsiveGaugeFactory.call("undefined"==typeof window?this:window);