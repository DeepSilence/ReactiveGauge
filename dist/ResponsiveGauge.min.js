/*!
 * ResponsiveGauge
 * version : 0.1.0
 * license : MIT
 * authors : MikaÃ«l Restoux, Matt Magoffin (http://bl.ocks.org/msqr/3202712)
 * 
 */
var ResponsiveGaugeFactory=function(e,t){"use strict";"undefined"==typeof d3&&(d3=e),"undefined"==typeof numbro&&(numbro=t);var a=6,n=2,r=100,i=40,l=numbro(),o=function(e,t){function a(e,t,a){0===t?this[a]=e+".a":this[a]=e+".["+new Array(t+1).join("0")+"]a"}var n;return t?(n="LABEL_FORMAT",void 0===this.LABEL_FORMAT&&a.call(this,this.labelMantissaMax,this.labelDecimalsMax,n)):(n="VALUE_FORMAT",void 0===this.VALUE_FORMAT&&a.call(this,this.valueMantissaMax,this.valueDecimalsMax,n)),l.set(e).format(this[n])},s={ringShift:3,ringWidth:7,minAngle:-90,maxAngle:90,sectorsNumber:5,border:!1,pointerType:"needle",pointerSlowness:200,needleLength:90,filamentLength:2,fillerWidth:NaN,fillerShift:0,minValue:0,maxValue:100,value:0,labelNumber:NaN,labelFormatter:function(e){return o.call(this,e,!0)},labelMantissaMax:4,labelDecimalsMax:0,labelShift:0,colors:!1,startColor:"#ffebee",endColor:"#810301",showValue:!0,valueShift:22,valueFormatter:function(e){return o.call(this,e,!1)},valueMantissaMax:4,valueDecimalsMax:0,valueUnit:""},u=function(e,t){function l(e){return e*Math.PI/180}function o(){if(isNaN(k.labelNumber)&&(k.labelNumber=k.sectorsNumber),0===k.labelNumber)return[];var e=(k.maxValue-k.minValue)/(k.labelNumber-1),t=d3.range(k.minValue,k.maxValue,e);return t.push(k.maxValue),t}function u(e){for(var t in s)k[t]=s[t];for(var t in e)k[t]=e[t],void 0===s[t]&&console.warn("Config property "+t+" is unknwon");k.FORMAT=void 0,k.labelFormatter=k.labelFormatter.bind(k),k.valueFormatter=k.valueFormatter.bind(k),b=k.maxAngle-k.minAngle,f(),M=d3.scale.linear().range([0,1]).domain([k.minValue,k.maxValue]),F=o(),k.colors.constructor===Array?(V=d3.range(k.sectorsNumber).map(function(){return 1/k.sectorsNumber}),R=function(e){var t=Math.floor(e*k.sectorsNumber);return t=Math.min(t,k.colors.length-1),k.colors[t]}):k.colors?(V="gradient"===k.colors?d3.range(i).map(function(){return 1/i}):d3.range(k.sectorsNumber).map(function(){return 1/k.sectorsNumber}),R=d3.interpolateHsl(d3.rgb(k.startColor),d3.rgb(k.endColor))):V=[1],S=d(function(e,t){var a=e*t,n=0===t?0:.5;return l(k.minAngle+a*b-n)},function(e,t){var a=e*(t+1);return l(k.minAngle+a*b)},k.ringWidth,k.ringShift),k.border&&(w=d(l(k.minAngle),l(k.maxAngle),k.ringWidth,k.ringShift)),"filler"===k.pointerType&&isNaN(k.fillerWidth)&&(k.fillerWidth=k.ringWidth,k.fillerShift=k.ringShift)}function d(e,t,a,n){return d3.svg.arc().innerRadius(L-a-n).outerRadius(L-n).startAngle(e).endAngle(t)}function c(){var e=JSON.parse(JSON.stringify(k));return Object.freeze(e),e}function f(){function e(e){return[t(n+e),t(r+e)]}function t(e){return i*Math.sin(l(e))}for(var n=k.minAngle,r=k.maxAngle,i=L-Math.min(k.ringShift,k.fillerShift,k.labelShift),o=0,s=0,u=0,d=0,c=Math.floor(n/90),f=Math.floor(r/90),p=c;f>=p;p++)switch(p%4){case 0:u=i;break;case 1:s=i;break;case 2:d=i;break;case 3:o=i}var m=e(0),g=e(-90);o=Math.abs(Math.min(-o,m[0],m[1])),s=Math.max(s,m[0],m[1]),u=Math.abs(Math.min(-u,g[0],g[1])),d=Math.max(d,g[0],g[1]),E=o+s+2*a,W=u+d+2*a;var h=u+a,v=o+a,b=3*i+4*a;W+E>b&&(j=!0,E+=2*a,W+=2*a,h+=a,v+=a),T="translate("+v+","+h+")"}function p(e){u(e),m();var t=y.append("g").attr("class","gauge-arc").attr("transform",T),a=t.selectAll("path").data(V).enter().append("path").attr("d",S);k.colors&&a.attr("fill",function(e,t){return R(e*t)}),k.border&&t.append("path").attr("fill","none").attr("class","gauge-arc-border").attr("d",w);var r=d3.svg.line().interpolate("monotone"),i=y.append("g").attr("class","gauge-pointer gauge-"+k.pointerType).attr("transform",T);if("filler"===k.pointerType)N=i.append("path");else if("needle"===k.pointerType)N=i.data([[[0,-n],[0,-k.needleLength/2]]]).append("path").attr("d",r),i.append("circle").attr("r",n);else if("filament"===k.pointerType){var l=L-k.ringShift-k.ringWidth-k.filamentLength,o=L-k.ringShift+k.filamentLength;N=i.data([[[0,-l],[0,-o]]]).append("path").attr("d",r)}y.append("g").attr("class","gauge-label").attr("transform",T).selectAll("text").data(F).enter().append("g").attr("transform",function(e){var t=M(e),a=k.minAngle+t*b;return"rotate("+a+") translate(0,"+(k.labelShift-L)+")"}).append("text").text(k.labelFormatter);if(k.showValue){var s=k.valueShift,d=k.minAngle+Math.abs(b)/2;j&&(s=0,d=0);var c="translate(0, "+-s+")",f=y.append("g").attr("class","gauge-value").attr("transform",T+" rotate("+d+")").append("g").attr("transform",c+" rotate("+-d+")").append("text");x=f.append("tspan").attr("dy","0.4em"),f.append("tspan").text(k.valueUnit).attr("class","unit").attr("x",0).attr("dy","1em")}}function m(){A=d3.select(e),window.navigator.userAgent.match(/(MSIE|Trident|Edge)/)&&(A=A.append("span").attr("class","gauge-container"),A.append("canvas").attr({"class":"gauge-ie-fix",width:E,height:W})),y=A.classed("wide-gauge",j).append("svg:svg").attr("class","gauge").attr("viewBox","0 0 "+E+" "+W).attr("preserveAspectRatio","xMinYMin meet")}function g(e){if("filler"===k.pointerType){var t=d(l(k.minAngle),l(v(e)),k.fillerWidth,k.fillerShift);N.attr("d",t)}else N.transition().duration(k.pointerSlowness).ease("elastic").attr("transform","rotate("+v(e)+")")}function h(e,t){e=void 0===e?0:e,g(e),k.showValue&&x.text(k.valueFormatter(e))}function v(e){var t=Math.max(e,k.minValue);t=Math.min(t,k.maxValue);var a=M(t);return k.minAngle+a*b}var b,M,x,A,y,N,S,w,F,V,R,T,k={},L=r/2,j=!1,E=0,W=0;return p(t),h(k.value),{update:h,getConfig:c,container:A}};return u.config=s,"undefined"!=typeof requirejs?u:void(this.ResponsiveGauge=u)};if("undefined"!=typeof requirejs){var protocol=document.location.protocol;protocol="file:"===protocol?"http:":protocol;var cssId="responsive-gauge-css";if(!document.getElementById(cssId)){var head=document.getElementsByTagName("head")[0],link=document.createElement("link");link.id=cssId,link.rel="stylesheet",link.type="text/css",link.href=protocol+"//cdn.rawgit.com/DeepSilence/ResponsiveGauge/69b33feebb300834edaa535df95fae1e68de59e9/dist/ResponsiveGauge.min.css",link.media="all",head.appendChild(link)}requirejs.config({paths:{d3:protocol+"//cdn.jsdelivr.net/d3js/3.5.16/d3.min",numbro:protocol+"//cdnjs.cloudflare.com/ajax/libs/numbro/1.7.1/numbro.min"}}),define(["d3","numbro"],function(e,t){return ResponsiveGaugeFactory(e,t)})}else ResponsiveGaugeFactory.call("undefined"==typeof window?this:window);